<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Profe Civilizado ¬∑ Recursos ESO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Recursos interactivos de Matem√°ticas y Programaci√≥n." />
  <link rel="stylesheet" href="assets/style.css" />
  <script defer src="assets/main.js"></script>

  <style>
    .details-block { margin: 10px 0; }
    .details-block summary { font-weight: 600; cursor: pointer; }
    .form-row{
      display:grid;
      grid-template-columns:160px 1fr;
      gap:10px;
      align-items:center;
      margin:8px 0
    }
    .result{
      font-weight:700;
      padding:10px;
      border:1px solid rgba(37,99,235,.25);
      border-radius:12px;
      background:rgba(37,99,235,.06);
      white-space:pre-wrap
    }
    .hidden{display:none}
    .embed-wrap{
      overflow:hidden;
      border-radius:12px;
      box-shadow:var(--shadow);
      background:var(--card)
    }
    .spacer{height:6px}
    .muted{color:var(--muted)}
    .status{font-size:14px;margin:8px 0}
    @media (max-width: 600px){
      .form-row{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
<!-- NAV -->
<nav>
  <div class="nav-inner">
    <a href="index.html" class="brand">Profe Civilizado</a>
    <div class="links">
      <a href="index.html">Inicio</a>
      <a href="sobre-mi.html">Sobre m√≠</a>
      <a href="recursos-eso.html" class="active">Recursos ESO</a>
      <a href="recursos-bachillerato.html">Recursos Bachillerato</a>
      <a href="contacto.html">Contacto</a>
    </div>
    <button id="themeToggle" class="toggle">üåì</button>
  </div>
</nav>

<main class="content">
<section class="panel">

<h3>Recursos interactivos</h3>
<p class="muted">Despliega lo que necesites. Compacto, claro y listo para clase.</p>

<!-- 1) GeoGebra -->
<details class="details-block">
  <summary>üìê Applet GeoGebra: Lugares geom√©tricos de un tri√°ngulo</summary>
  <div class="spacer"></div>
  <div class="embed-wrap">
    <iframe
      src="https://www.geogebra.org/material/iframe/id/hqfjmn2p/width/800/height/600"
      width="100%" height="500" style="border:0;" allowfullscreen loading="lazy">
    </iframe>
  </div>
</details>

<!-- 2) Pit√°goras -->
<details class="details-block" open>
  <summary>üêç Calculadora de Pit√°goras (Python en el navegador)</summary>

  <p class="status" id="py-status">Cargando motor de Python‚Ä¶</p>

  <div class="form-row">
    <label>Cateto a:</label>
    <input id="py-a" type="number" min="0">
  </div>
  <div class="form-row">
    <label>Cateto b:</label>
    <input id="py-b" type="number" min="0">
  </div>
  <div class="form-row">
    <span></span>
    <button id="btn-pitagoras" class="btn">Calcular</button>
  </div>

  <div id="py-out" class="result hidden"></div>
</details>

<!-- 3) FACTORIZACI√ìN -->
<details class="details-block">
  <summary>üßÆ Factorizaci√≥n de polinomios (Python paso a paso)</summary>

  <div class="form-row">
    <label>Grado:</label>
    <input id="fact-grado" type="number" min="0" placeholder="Ej. 1">
  </div>

  <div class="form-row">
    <label>Coeficientes:</label>
    <input id="fact-coefs" type="text" placeholder="Ej. 3, 6  (para 3x + 6)">
  </div>

  <div class="form-row">
    <span></span>
    <button id="fact-run" class="btn">Factorizar</button>
  </div>

  <pre id="fact-out" class="result hidden"></pre>
</details>

</section>
</main>

<footer>
¬© <span id="y"></span> Profe Civilizado ‚Äî Hecho con HTML & CSS
</footer>

<!-- PYODIDE -->
<script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>
<script>
let pyodide;

(async () => {
  pyodide = await loadPyodide();

  await pyodide.runPythonAsync(`
import math
from math import gcd

super_indices = {"0":"‚Å∞","1":"¬π","2":"¬≤","3":"¬≥","4":"‚Å¥","5":"‚Åµ","6":"‚Å∂","7":"‚Å∑","8":"‚Å∏","9":"‚Åπ"}
def exp_super(n):
    return "".join(super_indices[c] for c in str(n))

def limpiar_coeficientes(coefs):
    while len(coefs) > 1 and coefs[0] == 0:
        coefs = coefs[1:]
    return coefs

def mostrar_polinomio(coefs):
    grado = len(coefs) - 1
    partes = []
    for i, c in enumerate(coefs):
        if c == 0:
            continue
        exp = grado - i
        signo = " + " if c > 0 and partes else " - " if c < 0 else ""
        valor = abs(c)
        coef = "" if valor == 1 and exp > 0 else str(valor)
        if exp > 1:
            term = f"{coef}x{exp_super(exp)}"
        elif exp == 1:
            term = f"{coef}x"
        else:
            term = f"{coef}"
        partes.append(signo + term)
    return "".join(partes) if partes else "0"

def factor_lineal(r):
    if r == 0:
        return "(x)"
    return f"(x + {abs(r)})" if r < 0 else f"(x - {r})"

def factor_comun(coefs, salida):
    m = abs(coefs[0])
    for c in coefs[1:]:
        m = gcd(m, abs(c))
    if m == 1:
        m = None
    if not m:
        salida.append("No se puede extraer factor com√∫n.\n")
        return None, coefs
    nuevos = [c // m for c in coefs]
    salida.append(f"Factor com√∫n: {m}")
    salida.append(f"{m}¬∑({mostrar_polinomio(nuevos)})\n")
    return m, nuevos

def factorizar_web(grado, coefs):
    salida = []
    salida.append("=== FACTORIZACI√ìN PASO A PASO ===\n")
    coefs = limpiar_coeficientes(coefs)

    salida.append("Polinomio:")
    salida.append(mostrar_polinomio(coefs))
    salida.append("")

    if len(coefs) <= 1:
        salida.append("No se puede factorizar m√°s.")
        return "\\n".join(salida)

    factores = []
    fc, actual = factor_comun(coefs, salida)
    if fc:
        factores.append(str(fc))

    if len(actual) == 2:
        a, b = actual
        salida.append("Si igualamos el polinomio a 0:")
        salida.append(f"{a}x + {b} = 0")
        salida.append(f"{a}x = {-b}")
        r = -b // a
        salida.append(f"x = {r}\n")
        factores.append(factor_lineal(r))

    salida.append("Descomposici√≥n:")
    salida.append(" ¬∑ ".join(factores))
    salida.append("\nFin de la factorizaci√≥n.")
    return "\\n".join(salida)

def hipotenusa(a, b):
    return math.sqrt(a*a + b*b)
  `);

  document.getElementById("py-status").textContent =
    "Python cargado. ¬°Listo para calcular! üí™";
})();

// Pit√°goras
document.getElementById("btn-pitagoras").onclick = async () => {
  const a = parseFloat(py-a.value);
  const b = parseFloat(py-b.value);
  const out = document.getElementById("py-out");
  if (isNaN(a) || isNaN(b)) {
    out.textContent = "Introduce valores num√©ricos v√°lidos.";
    out.classList.remove("hidden");
    return;
  }
  const c = await pyodide.runPythonAsync(`hipotenusa(${a}, ${b})`);
  out.textContent = "Hipotenusa = " + c.toFixed(2);
  out.classList.remove("hidden");
};

// Factorizaci√≥n
document.getElementById("fact-run").onclick = async () => {
  const grado = parseInt(fact-grado.value);
  const raw = fact-coefs.value;
  const out = document.getElementById("fact-out");

  try {
    const coefs = raw.split(",").map(x => parseInt(x.trim()));
    pyodide.globals.set("g", grado);
    pyodide.globals.set("c", coefs);
    const res = await pyodide.runPythonAsync(`factorizar_web(g, c)`);
    out.textContent = res;
    out.classList.remove("hidden");
  } catch {
    out.textContent = "Revisa los datos introducidos.";
    out.classList.remove("hidden");
  }
};
</script>

</body>
</html>
